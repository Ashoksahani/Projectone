const crypto = require("crypto");

function verifyPassword(secret, hash, password, keylen = 32) {
    let passwordhash = crypto.pbkdf2Sync(password, secret, 1000, keylen, "sha512").toString("hex");
    return hash == passwordhash
}

function decrypt(payload, key, ivd) {
    // let iv = Buffer.from(ivd, 'hex');
    let encryptedText = Buffer.from(payload, 'hex');
    let decipher = crypto.createDecipheriv('aes-256-cbc', Buffer.from(key), ivd);
    let decrypted = decipher.update(encryptedText);
    decrypted = Buffer.concat([decrypted, decipher.final()]);
    return decrypted.toString();
}

module.exports = {
    verifyPassword,
    decrypt
}